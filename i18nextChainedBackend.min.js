!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).i18nextChainedBackend=n()}(this,(function(){"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var t=[],i=t.forEach,o=t.slice;function a(e){return i.call(o.call(arguments,1),(function(n){if(n)for(var t in n)void 0===e[t]&&(e[t]=n[t])})),e}function c(e){return e?"function"==typeof e?new e:e:null}var r=function(){function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(this,t),this.backends=[],this.type="backend",this.init(n,i)}var i,o,r;return i=t,(o=[{key:"init",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;this.services=e,this.options=a(t,this.options||{},{handleEmptyResourcesAsFailed:!0}),this.options.backends&&this.options.backends.forEach((function(t,o){n.backends[o]=n.backends[o]||c(t),n.backends[o].init(e,n.options.backendOptions&&n.options.backendOptions[o]||{},i)}))}},{key:"read",value:function(e,n,t){var i=this,o=this.backends.length,a=function t(o,a){if(!(o<0)){var c=i.backends[o];c.save?(c.save(e,n,a),t(o-1,a)):t(o-1,a)}};!function c(r){if(r>=o)return t(new Error("non of the backend loaded data;",!0));var s=r===o-1,f=i.options.handleEmptyResourcesAsFailed&&!s?0:-1,d=i.backends[r];d.read?d.read(e,n,(function(e,n){!e&&n&&Object.keys(n).length>f?(t(null,n,r),a(r-1,n)):c(r+1)})):c(r+1)}(0)}},{key:"create",value:function(e,n,t,i,o,a){this.backends.forEach((function(o){o.create&&o.create(e,n,t,i,null,a)}))}}])&&n(i.prototype,o),r&&n(i,r),Object.defineProperty(i,"prototype",{writable:!1}),t}();return r.type="backend",r}));
